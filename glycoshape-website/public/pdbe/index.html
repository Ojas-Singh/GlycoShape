<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">


    <title>PDBe Molstar - Helper functions</title>

    <!-- Molstar CSS & JS -->
    <link rel="stylesheet" type="text/css" href="https://www.ebi.ac.uk/pdbe/pdb-component-library/css/pdbe-molstar-light-3.1.2.css">
    <script type="text/javascript" src="https://www.ebi.ac.uk/pdbe/pdb-component-library/js/pdbe-molstar-plugin-3.1.2.js"></script>
    <style>
      * {
            margin-top: 0px;
            margin-bottom: 0px;
      }
      .msp-plugin ::-webkit-scrollbar-thumb {
          background-color: #eeeef8 !important;
      }
      .viewerSection {
        width: 800px;
        height: 600px;
        position: relative;
      }
      #myViewer{
        float:left;
        width: 780px;
        height: 580px;
        position:relative;
      }
    </style>
  </head>

  <body>
    <div class="viewerSection">
      <!-- Molstar container -->
      
      <div id="myViewer"></div>
      
    </div>
    <script>
        const urlParams = new URLSearchParams(window.location.search);
        const Url = urlParams.get('Url');
        const format = urlParams.get('format');

        
        if (Url && format) {
            // Load the PDB file from the given URL
            //Create plugin instance
      var viewerInstance = new PDBeMolstarPlugin();
  
  //Set options (Checkout available options list in the documentation)
  var options = {
    customData: {
      url: Url,
      format: format
    },
    alphafoldView: true,
    bgColor: {r:255, g:255, b:255},
    hideControls: true,  //only protein view set it to true
    expanded: true,
    sequencePanel: true,
    showDisplayControls: false ,
    onLoad: function(pluginInstance) {
      // Select residues 4 and 97 and add label representation
      pluginInstance.visual.select({ 
        data: [
          { struct_asym_id: 'A', start_residue_number: 4, end_residue_number: 4, label: 'Residue 4', color: {r:255, g:0, b:0} }, 
          { struct_asym_id: 'A', start_residue_number: 97, end_residue_number: 97, label: 'Residue 97', color: {r:0, g:0, b:255} }
        ]
      });
    }
    // hideCanvasControls: ['selection', 'animation', 'controlToggle', 'controlInfo', 'controlSettings']
  }
  
  //Get element from HTML/Template to place the viewer 
  var viewerContainer = document.getElementById('myViewer');

  //Call render method to display the 3D view
  viewerInstance.render(viewerContainer, options);
        }else {
            alert('Please provide a URL using the query parameter "Url" and "format".');
            // Optionally, you can redirect to a default page or provide a default URL.
        }
      
      
    </script>
  </body>

</html>